# 差分矩阵

对 $a$ 数组 $(x_1,y_1)$ 到 (x_2,y_2) 的矩阵块中所有元素加上常数 $c$，用差分数组 $b$ 执行以下操作可以实现：

```c++
b[x1][y1] += c;
b[x2 + 1][y1] -= c;
b[x1][y2 + 1] -= c;
b[x2 + 1][y2 + 1] += c;
```

通过求差分矩阵的前缀和得到 $a$ 数组：

```c++
for(int i = 1;i <= n;i++)
    for(int j = 1;j <= n;j++)
        b[i][j] += b[i - 1][j] + b[i][j - 1] - b[i - 1][j - 1] ;
```

$b$ 数组的通项公式：

```c++
//a[i][j] 是 b[1][1]到b[i][j] 的矩阵中所有元素之和
a[i][j] = a[i - 1][j] + a[i][j - 1] - a[i - 1][j - 1] + b[i][j]

//移项得到b[i][j] 的通项公式
b[i][j] = a[i][j] - a[i - 1][j] - a[i][j - 1] + a[i - 1][j - 1];
```